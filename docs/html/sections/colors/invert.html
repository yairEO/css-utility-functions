<section id="invert" class="function-section">
  <header>
    <h1><a href="#invert">--invert()</a></h1>
    <a href="https://github.com/yairEO/css-utility-functions/blob/main/src/colors/invert.css" target="_blank">Source code</a>
  </header>
  <p class="function-description">
    Invert a color by flipping its lightness in OKLCH space. Dark colors become light, light colors become dark.
  </p>

  <div class="parameters-section" style="margin: --space(4) 0;">
    <h3>Parameters</h3>
    <ul style="list-style: none; padding: 0; margin: --space(2) 0;">
      <li style="margin-bottom: --space(2);">
        <code style="font-weight: 600;">--color</code> <span style="color: var(--required-color);">(required)</span> â€” The base color.
      </li>
    </ul>
  </div>

  <div class="example-group">
    <h3>Basic Usage</h3>
    <div class="code-block">
      <code>.inverted {
  background: --invert(#ffffff);  // White becomes black
}

.dark-mode-text {
  color: --invert(var(--light-text));
}</code>
    </div>
    <style>
      .invert-demo-white { background: #ffffff; }
      .invert-demo-white-inv { background: --invert(#ffffff); }
      .invert-demo-black { background: #000000; }
      .invert-demo-black-inv { background: --invert(#000000); }
      .invert-demo-blue { background: var(--primary-color); }
      .invert-demo-blue-inv { background: --invert(var(--primary-color)); }
    </style>
    <div class="demo-grid">
      <div class="demo-item">
        <div class="color-demo invert-demo-white"></div>
        <div style="font-size: 0.875rem; margin-top: --space(2); font-family: monospace;">#ffffff</div>
      </div>
      <div class="demo-item">
        <div class="color-demo invert-demo-white-inv"></div>
        <div style="font-size: 0.875rem; margin-top: --space(2); font-family: monospace;">--invert(#ffffff)</div>
      </div>
      <div class="demo-item">
        <div class="color-demo invert-demo-black"></div>
        <div style="font-size: 0.875rem; margin-top: --space(2); font-family: monospace;">#000000</div>
      </div>
      <div class="demo-item">
        <div class="color-demo invert-demo-black-inv"></div>
        <div style="font-size: 0.875rem; margin-top: --space(2); font-family: monospace;">--invert(#000000)</div>
      </div>
      <div class="demo-item">
        <div class="color-demo invert-demo-blue"></div>
        <div style="font-size: 0.875rem; margin-top: --space(2); font-family: monospace;">var(--primary-color)</div>
      </div>
      <div class="demo-item">
        <div class="color-demo invert-demo-blue-inv"></div>
        <div style="font-size: 0.875rem; margin-top: --space(2); font-family: monospace;">--invert(var(--primary-color))</div>
      </div>
    </div>
  </div>

  <div class="example-group">
    <h3>Interactive Demo</h3>
    <div class="code-block">
      <code>.element {
  background: --invert(<span id="invert-color-val">#3b82f6</span>);
}</code>
    </div>
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin: 2rem 0; max-width: 500px; margin-left: auto; margin-right: auto;">
      <div>
        <div style="font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem; text-align: center;">Original Color</div>
        <div id="invert-original" style="width: 100%; height: 150px; background: #3b82f6; border-radius: 8px; border: 1px solid rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; text-shadow: 0 1px 2px rgba(0,0,0,0.3);">
          <span id="invert-original-text">#3b82f6</span>
        </div>
        <div style="display: flex; align-items: center; gap: 0.5rem; margin-top: 0.75rem;">
          <input type="color" id="invert-color" value="#3b82f6" style="width: 60px; height: 40px; border-radius: 4px; border: 1px solid rgba(0,0,0,0.2); cursor: pointer;">
          <input type="text" id="invert-color-hex" value="#3b82f6" style="flex: 1; padding: 0.5rem; border: 1px solid rgba(0,0,0,0.2); border-radius: 4px; font-family: monospace; font-size: 0.875rem;">
        </div>
      </div>
      <div>
        <div style="font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem; text-align: center;">Inverted Color</div>
        <div id="invert-result" style="width: 100%; height: 150px; background: --invert(#3b82f6); border-radius: 8px; border: 1px solid rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; font-weight: 600; text-shadow: 0 1px 2px rgba(0,0,0,0.1);">
          <span id="invert-result-text">--invert(#3b82f6)</span>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
(function() {
  const original = document.getElementById('invert-original');
  const result = document.getElementById('invert-result');
  const colorPicker = document.getElementById('invert-color');
  const colorHex = document.getElementById('invert-color-hex');
  const colorVal = document.getElementById('invert-color-val');
  const originalText = document.getElementById('invert-original-text');
  const resultText = document.getElementById('invert-result-text');

  function updateColor(color) {
    // Normalize color value
    color = color.trim();
    if (!color.startsWith('#')) {
      color = '#' + color;
    }
    
    // Update color picker if it's a valid hex
    if (/^#[0-9A-Fa-f]{6}$/.test(color)) {
      colorPicker.value = color;
    }
    
    // Update displays
    original.style.background = color;
    result.style.background = `--invert(${color})`;
    colorVal.textContent = color;
    originalText.textContent = color;
    resultText.textContent = `--invert(${color})`;
    
    // Update text color for contrast
    const rgb = hexToRgb(color);
    const brightness = (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;
    original.style.color = brightness > 128 ? '#000' : '#fff';
    original.style.textShadow = brightness > 128 ? '0 1px 2px rgba(255,255,255,0.5)' : '0 1px 2px rgba(0,0,0,0.3)';
    
    // For inverted color, we need to check the inverted brightness
    const invertedRgb = hexToRgb(invertHex(color));
    const invertedBrightness = (invertedRgb.r * 299 + invertedRgb.g * 587 + invertedRgb.b * 114) / 1000;
    result.style.color = invertedBrightness > 128 ? '#000' : '#fff';
    result.style.textShadow = invertedBrightness > 128 ? '0 1px 2px rgba(255,255,255,0.5)' : '0 1px 2px rgba(0,0,0,0.3)';
  }

  function hexToRgb(hex) {
    const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result ? {
      r: parseInt(result[1], 16),
      g: parseInt(result[2], 16),
      b: parseInt(result[3], 16)
    } : { r: 0, g: 0, b: 0 };
  }

  function invertHex(hex) {
    const rgb = hexToRgb(hex);
    // Simple RGB inversion (not the same as OKLCH inversion, but good enough for text contrast)
    return '#' + [255 - rgb.r, 255 - rgb.g, 255 - rgb.b].map(x => {
      const hex = x.toString(16);
      return hex.length === 1 ? '0' + hex : hex;
    }).join('');
  }

  colorPicker.oninput = function() {
    colorHex.value = colorPicker.value;
    updateColor(colorPicker.value);
  };

  colorHex.oninput = function() {
    updateColor(colorHex.value);
  };

  colorHex.onblur = function() {
    updateColor(colorHex.value);
  };
})();
</script>

